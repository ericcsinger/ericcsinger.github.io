<!doctype html>
<html class="position-relative" itemscope itemtype="https://schema.org/WebPage" lang="en"
  data-bs-theme="auto" data-palette="blue">
  <head><script src="/assets/init/bundle.min.2232e70cd03e25718136e7eb51d0b7aac3fb2a2161c5553fb49ad1dfdc9881e0.js" integrity="sha256-IjLnDNA&#43;JXGBNufrUdC3qsP7KiFhxVU/tJrR39yYgeA=" crossorigin="anonymous"></script>
<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Azure Bicep Conditional Properties Part 04, Helper Modules - Eric&#39;s Blog</title>
    <link rel="icon" href="/favicon_hu_e83888ddb6472856.png" sizes="16x16" type="image/png">
    <link rel="icon" href="/favicon_hu_276a61518911b273.png" sizes="32x32" type="image/png">
    <link rel="icon" href="/favicon_hu_1fce3f16494f6ae3.png" sizes="150x150" type="image/png">
    <link rel="apple-touch-icon" href="/favicon_hu_f105fae78c239d0f.png" sizes="180x180" type="image/png">
    <link rel="icon" href="/favicon_hu_af357fe99fc0195a.png" sizes="192x192" type="image/png">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#6f42c1">
<meta name="keywords" content="iac, azure, bicep, arm, automation, microsoft, deployment" />
  <meta name="description" content="Version: 1.0.0

Series Introduction
Whether you&rsquo;re new to ARM/Bicep or a pro, I&rsquo;m sure you&rsquo;ve run into the issue of needing conditional properties.  Unfortunately, ARM and Bicep do not officially have functions built in to handle this natively.  At least not as of yet.  I was surprised when writing this, to not see a whole lot of articles showing how work around this.
In this series, I&rsquo;m going to show you a few ways you can work a round this.  All of them are convoluted, but they do work.  Each one will have pros and cons, and it will be up to you determine which one you like best.  Of course, you don&rsquo;t have to stick to one or other.  Like most things in technology, use what works best in your situation." />
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Azure Bicep Conditional Properties Part 04, Helper Modules">
  <meta name="twitter:description" content="Version: 1.0.0
Series Introduction Whether you’re new to ARM/Bicep or a pro, I’m sure you’ve run into the issue of needing conditional properties. Unfortunately, ARM and Bicep do not officially have functions built in to handle this natively. At least not as of yet. I was surprised when writing this, to not see a whole lot of articles showing how work around this.
In this series, I’m going to show you a few ways you can work a round this. All of them are convoluted, but they do work. Each one will have pros and cons, and it will be up to you determine which one you like best. Of course, you don’t have to stick to one or other. Like most things in technology, use what works best in your situation.">
      <meta name="twitter:site" content="@esinger">
<meta property="og:url" content="https://ericcsinger.com/azure-bicep-conditional-properties-part-04-helper-modules/">
  <meta property="og:site_name" content="Eric&#39;s Blog">
  <meta property="og:title" content="Azure Bicep Conditional Properties Part 04, Helper Modules">
  <meta property="og:description" content="Version: 1.0.0
Series Introduction Whether you’re new to ARM/Bicep or a pro, I’m sure you’ve run into the issue of needing conditional properties. Unfortunately, ARM and Bicep do not officially have functions built in to handle this natively. At least not as of yet. I was surprised when writing this, to not see a whole lot of articles showing how work around this.
In this series, I’m going to show you a few ways you can work a round this. All of them are convoluted, but they do work. Each one will have pros and cons, and it will be up to you determine which one you like best. Of course, you don’t have to stick to one or other. Like most things in technology, use what works best in your situation.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-09-10T12:00:00+00:00">
    <meta property="article:modified_time" content="2022-09-10T12:00:00+00:00">
    <meta property="article:tag" content="Arm">
    <meta property="article:tag" content="Automation">
    <meta property="article:tag" content="Azure">
    <meta property="article:tag" content="Bicep">
    <meta property="article:tag" content="IaC">
    <meta property="article:tag" content="Microsoft">
      <meta property="og:see_also" content="https://ericcsinger.com/azure-bicep-conditional-properties-part-03-template-variables/">
      <meta property="og:see_also" content="https://ericcsinger.com/azure-bicep-conditional-properties-part-02-parameters/">
      <meta property="og:see_also" content="https://ericcsinger.com/azure-bicep-conditional-properties-part-01-introduction/">

  <meta itemprop="name" content="Azure Bicep Conditional Properties Part 04, Helper Modules">
  <meta itemprop="description" content="Version: 1.0.0
Series Introduction Whether you’re new to ARM/Bicep or a pro, I’m sure you’ve run into the issue of needing conditional properties. Unfortunately, ARM and Bicep do not officially have functions built in to handle this natively. At least not as of yet. I was surprised when writing this, to not see a whole lot of articles showing how work around this.
In this series, I’m going to show you a few ways you can work a round this. All of them are convoluted, but they do work. Each one will have pros and cons, and it will be up to you determine which one you like best. Of course, you don’t have to stick to one or other. Like most things in technology, use what works best in your situation.">
  <meta itemprop="datePublished" content="2022-09-10T12:00:00+00:00">
  <meta itemprop="dateModified" content="2022-09-10T12:00:00+00:00">
  <meta itemprop="wordCount" content="3087">
  <meta itemprop="keywords" content="iac,azure,bicep,arm,automation,microsoft,deployment">

      <script async src="https://www.googletagmanager.com/gtag/js?id=G-B4G7NX7JV6"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-B4G7NX7JV6');
        }
      </script>
<link data-precache rel="stylesheet" href="/assets/main/bundle.min.356a9760bdbac40681ce47a16bc4b7f78053a86b772594c63870d4face095fc0.css" integrity="sha256-NWqXYL26xAaBzkeha8S394BTqGt3JZTGOHDU+s4JX8A=" crossorigin="anonymous">

<link data-precache rel="stylesheet" href="/assets/katex/bundle.min.b556ec958bd1c02e7341a64d31ec7c9cd88375ba59b282a7df7b7ff99901ccd2.css" integrity="sha256-tVbslYvRwC5zQaZNMex8nNiDdbpZsoKn33t/&#43;ZkBzNI=" crossorigin="anonymous">

    <link data-precache rel="stylesheet" href="/assets/viewer/bundle.min.8c1002839fa22c1350d6ae1eef6593120e108f973c41348be9b5065430566aaf.css" integrity="sha256-jBACg5&#43;iLBNQ1q4e72WTEg4Qj5c8QTSL6bUGVDBWaq8=" crossorigin="anonymous">


</head>
  <body><header class="mb-4 sticky-top">
  
<nav class="top-app-bar shadow navbar navbar-expand-xxl">
  <div class="container">
<a class="navbar-brand d-flex align-items-center flex-grow-1 flex-xxl-grow-0 justify-content-xxl-start ms-2 ms-xxl-0 mx-auto me-xxl-2"
    href="https://ericcsinger.com/">Eric&#39;s Blog
</a>

    <div class="offcanvas-xxl offcanvas-end flex-grow-1" data-bs-scroll="true" tabindex="-1" id="navbarMenus" aria-labelledby="navbarMenusLabel">
      <div class="offcanvas-header px-4 pb-0">
        <div class="offcanvas-title h5" id="navbarMenusLabel">Eric&#39;s Blog</div>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" data-bs-target="#navbarMenus" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body p-4 pt-0 p-xxl-0">
        <hr class="d-xxl-none">
        <ul class="navbar-nav flex-row flex-wrap align-items-center me-auto"><li class="nav-item col-6 col-xxl-auto">
            <a class="nav-link py-2 px-0 px-xxl-2" href="https://ericcsinger.com/about/">About
            </a>
          </li>
        </ul>
        
    <hr class="d-xxl-none">
    <form class="search-bar ms-auto my-auto" action="" novalidate>
      <div class="input-group align-items-center">
        <span class="btn btn-search disabled position-absolute left-0 border-0 px-1">
          <i class="fas fa-fw fa-search fa-lg"></i>
        </span>
        <input
          class="my-1 form-control border-white rounded-5 search-input bg-body"
          name="q"
          type="search"
          placeholder="Search"
          aria-label="Search"
          required>
          <span class="search-shortcut position-absolute end-0 top-0 me-2">
            <kbd class="text-dark bg-white opacity-75 rounded-3 shadow border border-primary py-1 fw-bold">/</kbd>
          </span>
      </div>
    </form><hr class="d-xxl-none">
        <ul class="navbar-nav flex-row flex-wrap align-items-center ms-md-auto">
<li class="nav-item dropdown col-6 col-xxl-auto">
    <a class="nav-link px-0 py-2 px-xxl-1" href="#" id="paletteDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        <i class="fas fa-fw fa-palette"></i>
        <span class="d-xxl-none">Palette</span>
    </a>
    <ul class="palette-dropdown-menu dropdown-menu dropdown-menu-end px-2 row g-2" aria-labelledby="paletteDropdown">
            <li class="col-4 my-1">
                <a role="button" id="palette-blue" aria-label="Blue"
                    class="btn btn-sm w-100 palette text-bg-blue" data-palette="blue">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-blue-gray" aria-label="Blue Gray"
                    class="btn btn-sm w-100 palette text-bg-blue-gray" data-palette="blue-gray">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-brown" aria-label="Brown"
                    class="btn btn-sm w-100 palette text-bg-brown" data-palette="brown">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-cyan" aria-label="Cyan"
                    class="btn btn-sm w-100 palette text-bg-cyan" data-palette="cyan">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-green" aria-label="Green"
                    class="btn btn-sm w-100 palette text-bg-green" data-palette="green">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-indigo" aria-label="Indigo"
                    class="btn btn-sm w-100 palette text-bg-indigo" data-palette="indigo">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-orange" aria-label="Orange"
                    class="btn btn-sm w-100 palette text-bg-orange" data-palette="orange">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-pink" aria-label="Pink"
                    class="btn btn-sm w-100 palette text-bg-pink" data-palette="pink">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-purple" aria-label="Purple"
                    class="btn btn-sm w-100 palette text-bg-purple" data-palette="purple">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-red" aria-label="Red"
                    class="btn btn-sm w-100 palette text-bg-red" data-palette="red">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-teal" aria-label="Teal"
                    class="btn btn-sm w-100 palette text-bg-teal" data-palette="teal">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-yellow" aria-label="Yellow"
                    class="btn btn-sm w-100 palette text-bg-yellow" data-palette="yellow">
                </a>
            </li>
    </ul>
</li>
<li class="nav-item dropdown col-6 col-xxl-auto">
    <a class="nav-link px-0 py-2 px-xxl-1" href="#" id="modeDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        <i class="mode-icon fas fa-fw fa-adjust" id="modeIcon"></i>
        <span class="d-xxl-none">Mode</span>
    </a>
    <ul class="mode-dropdown-menu dropdown-menu dropdown-menu-end" aria-labelledby="modeDropdown">
        <li class="mode-item" data-color-mode="light" data-icon="sun">
            <button class="dropdown-item">
                <i class="mode-icon fas fa-fw fa-sun"></i> Light
            </button>
        </li>
        <li class="mode-item" data-color-mode="dark" data-icon="moon">
            <button class="dropdown-item">
                <i class="mode-icon fas fa-fw fa-moon"></i> Dark
            </button>
        </li>
        <li class="mode-item active" data-color-mode="auto" data-icon="adjust">
            <button class="dropdown-item">
                <i class="mode-icon fas fa-fw fa-adjust"></i> Auto
            </button>
        </li>
    </ul>
</li>
        </ul>
      </div>
    </div>
    <div class="d-flex">
      <button class="navbar-toggler order-5 border-0" type="button" data-bs-toggle="offcanvas" data-bs-target="#navbarMenus"
        aria-controls="navbarMenus" aria-expanded="false" aria-label="Toggle navigation">
        <i class="fas fa-ellipsis-h"></i>
      </button>
    </div>
  </div>
</nav>

</header>

    <main class="container has-sidebar" data-kind="page"><script data-precache src="/js/main-init.6eaf083f43f73eb9a5e7053a7319f846fc45da423be9e1e17cd536403c4e5c9c.js" integrity="sha256-bq8IP0P3Prml5wU6cxn4RvxF2kI76eHhfNU2QDxOXJw=" crossorigin="anonymous"></script>

      <div class="row content"><noscript>
    <div class="alert alert-danger" role="alert">Your browser does not support JavaScript.</div>
</noscript>

<div class="content-posts col-xxl-8">
  <div class="container"><nav class="row card component" aria-label="breadcrumb">
  <div class="card-body pb-0">
    <ol class="hbs-breadcrumb breadcrumb flex-nowrap"><li class="breadcrumb-item text-surface"><a href="/">Home</a></li><li class="breadcrumb-item text-surface"><a href="/posts/">Posts</a></li><li class="breadcrumb-item active">Azure Bicep Conditional Properties Part 04, Helper Modules</li></ol>
  </div>
</nav><div class="post-panel-wrapper position-relative d-flex justify-content-center">
  <div class="d-flex flex-row justify-content-center rounded-5 border post-panel position-fixed px-3 py-1 surface shadow-1">
    
    

    
    
    
  <a class="action action-toc d-none d-xxl-block" href="#postTOC" role="button" title="Contents">
    <i class="fas fa-fw fa-list-alt"></i>
  </a>
<a class="action action-toc d-block d-xxl-none" href="#post-toc-container" role="button" title="Contents">
  <i class="fas fa-fw fa-list-alt"></i>
</a>
    <a class="action action-copyright" href="#post-copyright" role="button" aria-label="Copyright" title="Copyright">
  <i class="fas fa-fw fa-copyright"></i>
</a>
    <a class="action action-post-comments" href="#post-comments" role="button" aria-label="Comments" title="Comments">
  <i class="fas fa-fw fa-comments"></i>
</a>
    
<a id="sidebarToggler" class="action action-sidebar-toggler d-none d-xxl-block" role="button" title="Toggle sidebar">
  <i class="fas fa-fw fa-expand-alt" data-fa-transform="rotate-45"></i>
</a>

    
  </div>
</div><article class="row card component mb-4 post">
  <div class="card-header ">
    <h1 class="card-title post-title my-2">Azure Bicep Conditional Properties Part 04, Helper Modules</h1>
  </div>
  <div class="card-body"><div class="post-meta mb-3">
  <span class="post-date me-1 mb-1" title="created on 2022-09-10 08:00:00 -0400 EDT.">Sat, 10 Sep 2022 12:00:00 &#43;0000</span><span class="post-reading-time me-1 mb-1">15 min read</span><a href="/series/azure-bicep-conditional-properties/" class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-series">
      <i class="fas fa-fw fa-columns me-1"></i>Azure Bicep Conditional Properties</a><a href="/tags/arm/" class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">Arm</a><a href="/tags/automation/" class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">Automation</a><a href="/tags/azure/" class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">Azure</a><a href="/tags/bicep/" class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">Bicep</a><a href="/tags/iac/" class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">IaC</a><a href="/tags/microsoft/" class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">Microsoft</a>
</div>

<div class="mt-2 mb-3 d-block d-xxl-none">
    <h2 class="text-surface mb-3">Contents</h2>
    <div id="post-toc-container">
        </div>
    <hr class="text-secondary">
</div><div class="post-content mb-3" data-bs-spy="scroll" data-bs-target="#TableOfContents" tabindex="0">
        <div id="post-content-body"><p><em>Version: 1.0.0</em></p>

<h2 id="series-introduction" data-numberify>Series Introduction<a class="anchor ms-1" href="#series-introduction"></a></h2>
<p>Whether you&rsquo;re new to ARM/Bicep or a pro, I&rsquo;m sure you&rsquo;ve run into the issue of needing conditional properties.  Unfortunately, ARM and Bicep do not officially have functions built in to handle this natively.  At least not as of yet.  I was surprised when writing this, to not see a whole lot of articles showing how work around this.</p>
<p>In this series, I&rsquo;m going to show you a few ways you can work a round this.  All of them are convoluted, but they do work.  Each one will have pros and cons, and it will be up to you determine which one you like best.  Of course, you don&rsquo;t have to stick to one or other.  Like most things in technology, use what works best in your situation.</p>

<h3 id="series-index" data-numberify>Series Index<a class="anchor ms-1" href="#series-index"></a></h3>
<ul>
<li><a href="/azure-bicep-conditional-properties-part-01-introduction">Part 01, Introduction</a></li>
<li><a href="/azure-bicep-conditional-properties-part-02-parameters">Part 02, Parameters</a></li>
<li><a href="/azure-bicep-conditional-properties-part-03-template-variables">Part 03, Template Variables</a></li>
<li><a href="/azure-bicep-conditional-properties-part-04-helper-modules">Part 04, Helper Modules</a></li>
</ul>

<h3 id="series-demo-setup" data-numberify>Series Demo Setup<a class="anchor ms-1" href="#series-demo-setup"></a></h3>
<p>In this series demo, I&rsquo;ll show you how I solved the issue with conditional properties in the virtual network &ldquo;subnet&rdquo; properties.  This was a particularly challenging one as it&rsquo;s an array of objects.  I chose this for our series example to show you how to handle conditional properties in more complex scenarios.</p>
<p>Throughout this series, we&rsquo;ll use a common set of files to demonstrate both working and non-working examples.  The contents of the files will change throughout each post, so I would suggest creating a folder structure that looks something like this.</p>
<ul>
<li>Root Directory
<ul>
<li>1</li>
<li>2</li>
<li>3</li>
<li>etc.</li>
</ul>
</li>
</ul>
<p>You can store a copy of the files used in the demo in each folder.  This will allow you to walk through each option, and go back to previous posts if you need to review.</p>

<h2 id="article-introduction" data-numberify>Article Introduction<a class="anchor ms-1" href="#article-introduction"></a></h2>
<p>In part 3 we established that Bicep is not a programming language, but that doesn&rsquo;t mean we can&rsquo;t work a round some of it&rsquo;s limitations.  In this article, I want to show you how to deal with conditional properties in nested object.  This builds on what we already learned in part 3 and extends your abilities to build some powerful templates with a few simple helper <a href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/bicep/modules" target="_blank" rel="noopener noreferrer">modules<i class="fas fa-external-link-square-alt ms-1"></i></a>.</p>

<h2 id="article-demo-setup" data-numberify>Article Demo Setup<a class="anchor ms-1" href="#article-demo-setup"></a></h2>
<p>For this article, you will need the following files.</p>
<ul>
<li><strong>parameters.ps1:</strong> This file is used to define / generate our deployment parameters.</li>
<li><strong>template.bicep:</strong> This file is the main bicep template that consumes the deployment parameters and ultimately executes the deployment.</li>
<li><strong>templateSubnetHelper.bicep:</strong> This file is used by the main template to conditionally create a subnet object.</li>
<li><strong>templateArrayHelper.bicep:</strong>  This is used by the main template to take the results of a module, and convert it into a generic array that&rsquo;s easier to consume.</li>
<li><strong>deploy.ps1:</strong>  This file is used to execute the deployment.</li>
</ul>
<p>You can find the snippets of each file below.  Keep in mind, these might change from article to article, so I suggest overwriting your local copies if you&rsquo;re following along.</p>

<h3 id="parametersps1" data-numberify>parameters.ps1<a class="anchor ms-1" href="#parametersps1"></a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#75715e">#############################</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#START: Parameters</span>
</span></span><span style="display:flex;"><span>[CmdletBinding()]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">param</span> (
</span></span><span style="display:flex;"><span>    [Parameter(<span style="color:#a6e22e">Mandatory</span> = $true)]
</span></span><span style="display:flex;"><span>    [<span style="color:#66d9ef">string</span>]$TeamName = <span style="color:#e6db74">&#39;team1&#39;</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#END: Parameters</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#############################</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#############################</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#START: Variables</span>
</span></span><span style="display:flex;"><span>$networkPrefix = <span style="color:#e6db74">&#34;10.0&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$googleDNSServer = @{
</span></span><span style="display:flex;"><span>    dhcpOptions = @{
</span></span><span style="display:flex;"><span>        dnsServers = @(
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;8.8.8.8&#39;</span>
</span></span><span style="display:flex;"><span>            )
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#END: Variables</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#############################</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#########################################</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#START: allSubnets</span>
</span></span><span style="display:flex;"><span>$allSubnets = @(
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#########################################</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#START: GatewaySubnet</span>
</span></span><span style="display:flex;"><span>    @{
</span></span><span style="display:flex;"><span>    name = <span style="color:#e6db74">&#34;GatewaySubnet&#34;</span>
</span></span><span style="display:flex;"><span>    addressPrefix = <span style="color:#e6db74">&#34;</span>$($networkPrefix)<span style="color:#e6db74">.0.0/24&#34;</span>
</span></span><span style="display:flex;"><span>    applicationGatewayIpConfigurations = @()
</span></span><span style="display:flex;"><span>    delegations = @()
</span></span><span style="display:flex;"><span>    natGateway = @()
</span></span><span style="display:flex;"><span>    networkSecurityGroup = @{}
</span></span><span style="display:flex;"><span>    privateEndpointNetworkPolicies = <span style="color:#e6db74">&#34;Disabled&#34;</span>
</span></span><span style="display:flex;"><span>    privateLinkServiceNetworkPolicies = <span style="color:#e6db74">&#34;Disabled&#34;</span>
</span></span><span style="display:flex;"><span>    routeTable= @{}
</span></span><span style="display:flex;"><span>    serviceEndpointPolicies = @()
</span></span><span style="display:flex;"><span>    serviceEndpoints = @()
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#END: GatewaySubnet</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#########################################</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#########################################</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#START: webFarmSubnet</span>
</span></span><span style="display:flex;"><span>    @{
</span></span><span style="display:flex;"><span>    name = <span style="color:#e6db74">&#34;webFarm1&#34;</span>
</span></span><span style="display:flex;"><span>    addressPrefix = <span style="color:#e6db74">&#34;</span>$($networkPrefix)<span style="color:#e6db74">.10.0/24&#34;</span>
</span></span><span style="display:flex;"><span>    applicationGatewayIpConfigurations = @()
</span></span><span style="display:flex;"><span>    delegations = @(
</span></span><span style="display:flex;"><span>        @{
</span></span><span style="display:flex;"><span>        name = <span style="color:#e6db74">&#34;Microsoft.Web/serverFarms&#34;</span>
</span></span><span style="display:flex;"><span>        properties = @{
</span></span><span style="display:flex;"><span>            serviceName = <span style="color:#e6db74">&#34;Microsoft.Web/serverFarms&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>    natGateway = @{}
</span></span><span style="display:flex;"><span>    networkSecurityGroup = @{}
</span></span><span style="display:flex;"><span>    privateEndpointNetworkPolicies = <span style="color:#e6db74">&#34;Disabled&#34;</span>
</span></span><span style="display:flex;"><span>    privateLinkServiceNetworkPolicies = <span style="color:#e6db74">&#34;Disabled&#34;</span>
</span></span><span style="display:flex;"><span>    routeTable = @{}
</span></span><span style="display:flex;"><span>    serviceEndpointPolicies = @()
</span></span><span style="display:flex;"><span>    serviceEndpoints = @()
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#END: webFarmSubnet</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#########################################</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#############################</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#START: Base Template</span>
</span></span><span style="display:flex;"><span>$template = @{
</span></span><span style="display:flex;"><span>    name = <span style="color:#e6db74">&#34;vnet</span>$($TeamName)<span style="color:#e6db74">&#34;</span> <span style="color:#75715e">#notice we now have a dynamic name vnet based on the team name</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#location = &#39;eastUS&#39;</span>
</span></span><span style="display:flex;"><span>    tags = @{environment = <span style="color:#e6db74">&#39;sandbox&#39;</span>}
</span></span><span style="display:flex;"><span>    addressPrefixes = @(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;</span>$($networkPrefix)<span style="color:#e6db74">.0.0/16&#34;</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#Notice we have no dhcpOption property specified</span>
</span></span><span style="display:flex;"><span>    enableDdosProtection = $false
</span></span><span style="display:flex;"><span>    enableVmProtection = $false
</span></span><span style="display:flex;"><span>    subnets = $allSubnets
</span></span><span style="display:flex;"><span>    virtualNetworkPeerings = @()
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span><span style="color:#75715e">#END: Base Template</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#############################</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#############################</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#START: Conditional update</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">If</span> ($TeamName <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#34;One&#34;</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>    $template.add(<span style="color:#e6db74">&#39;dhcpOptions&#39;</span>, $googleDNSServer.dhcpOptions)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">If</span> ($TeamName <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#34;Two&#34;</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>    $template.remove(<span style="color:#e6db74">&#39;subnets&#39;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#END: Conditional update</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#############################</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#############################</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#START: Output Object</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$template
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#END: Output Object</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#############################</span>
</span></span></code></pre></div>
<h3 id="templatebicep" data-numberify>template.bicep<a class="anchor ms-1" href="#templatebicep"></a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Bicep" data-lang="Bicep"><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//START: res_networkVirtualNetwork</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">param</span> deploymentObject object
</span></span><span style="display:flex;"><span><span style="color:#75715e">//END: res_networkVirtualNetwork</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//START: variables</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> defaultLocation = <span style="color:#e6db74">&#39;EastUs&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//END: variables</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//START: conditionally build subnets</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> subnetsPropertyDefined = <span style="color:#a6e22e">contains</span>(deploymentObject, <span style="color:#e6db74">&#39;subnets&#39;</span>) <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span> ? <span style="color:#66d9ef">true</span> : <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> subnetsExistToBeDeploy = subnetsPropertyDefined <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span> ? <span style="color:#a6e22e">empty</span>(deploymentObject.subnets) <span style="color:#f92672">==</span> <span style="color:#66d9ef">false</span> : <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> subnetsToDeploy = subnetsExistToBeDeploy <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span> ? deploymentObject.subnets : []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">module</span> mod_allSubnets <span style="color:#e6db74">&#39;templateSubnetHelper.bicep&#39;</span> = [<span style="color:#66d9ef">for</span> subnet <span style="color:#66d9ef">in</span> subnetsToDeploy: <span style="color:#a6e22e">if</span>(subnetsExistToBeDeploy <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>  name: <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">uniqueString</span>(deploymentObject.name)<span style="color:#e6db74">}</span><span style="color:#e6db74">_</span><span style="color:#e6db74">${</span>subnet.name<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>  params:{
</span></span><span style="display:flex;"><span>    subnetObject: subnet
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">module</span> mod_arrayHelper <span style="color:#e6db74">&#39;templateArrayHelper.bicep&#39;</span> = <span style="color:#a6e22e">if</span>(subnetsExistToBeDeploy <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>  name: <span style="color:#e6db74">&#39;arrayHelper_</span><span style="color:#e6db74">${</span>deploymentObject.name<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>  params:{
</span></span><span style="display:flex;"><span>    array0: [<span style="color:#66d9ef">for</span> (subnetName, index) <span style="color:#66d9ef">in</span> subnetsToDeploy: mod_allSubnets[index].outputs.subnet ]
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//END: conditionally build subnets</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//START: conditionally properties</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Create a base property</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> baseProperties = {
</span></span><span style="display:flex;"><span>  addressSpace: {
</span></span><span style="display:flex;"><span>    addressPrefixes: deploymentObject.addressPrefixes
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Dynamically check the paramters for each property to see if it exists.  If so, we define it, if not, we create a blank object</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> dhcpOptions = <span style="color:#a6e22e">contains</span>(deploymentObject, <span style="color:#e6db74">&#39;dhcpOptions&#39;</span>) ? {dhcpOptions: deploymentObject.dhcpOptions} : {}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> subnets = subnetsExistToBeDeploy <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span> ? {subnets: mod_arrayHelper.outputs.arrayunion } : {}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> enableDdosProtection = <span style="color:#a6e22e">contains</span>(deploymentObject, <span style="color:#e6db74">&#39;enableDdosProtection&#39;</span>) ? {enableDdosProtection: deploymentObject.enableDdosProtection} : {}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> enableVmProtection = <span style="color:#a6e22e">contains</span>(deploymentObject, <span style="color:#e6db74">&#39;enableVmProtection&#39;</span>) ? {enableVmProtection: deploymentObject.enableVmProtection} : {}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> virtualNetworkPeerings = <span style="color:#a6e22e">contains</span>(deploymentObject, <span style="color:#e6db74">&#39;virtualNetworkPeerings&#39;</span>) ? {virtualNetworkPeerings: deploymentObject.virtualNetworkPeerings} : {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Merge all of the objects together into the complete object</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> properties = <span style="color:#a6e22e">union</span>(baseProperties,dhcpOptions,subnets,enableDdosProtection,enableVmProtection,virtualNetworkPeerings)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//END: conditionally build properties</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//START: res_networkVirtualNetwork</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">resource</span> res_networkVirtualNetwork <span style="color:#e6db74">&#39;Microsoft.Network/virtualNetworks@2021-03-01&#39;</span> = {
</span></span><span style="display:flex;"><span>  name: deploymentObject.name
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//Dynamic property value for location</span>
</span></span><span style="display:flex;"><span>  location: <span style="color:#a6e22e">contains</span>(deploymentObject, <span style="color:#e6db74">&#39;location&#39;</span>) ? deploymentObject.location : defaultLocation
</span></span><span style="display:flex;"><span>  tags: deploymentObject.tags
</span></span><span style="display:flex;"><span>  properties: properties
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span><span style="color:#75715e">//END: res_networkVirtualNetwork</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">///////////////////////////////////////</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//START: res_networkVirtualNetwork</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">output</span> outputProperties object = properties
</span></span><span style="display:flex;"><span><span style="color:#75715e">//END: res_networkVirtualNetwork</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span></code></pre></div>
<h3 id="templatesubnethelperbicep" data-numberify>templateSubnetHelper.bicep<a class="anchor ms-1" href="#templatesubnethelperbicep"></a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Bicep" data-lang="Bicep"><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//START: targetScope</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">targetScope</span> = <span style="color:#e6db74">&#39;resourceGroup&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//END: targetScope</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//START: parameters</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>@<span style="color:#a6e22e">description</span>(<span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">param</span> subnetObject object
</span></span><span style="display:flex;"><span><span style="color:#75715e">//END: parameters</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//START: variables</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//END: variables</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//START: Build subnet object</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> addressPrefix = {
</span></span><span style="display:flex;"><span>  addressPrefix: subnetObject.addressPrefix
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> delegations = <span style="color:#a6e22e">empty</span>(subnetObject.delegations) ? {
</span></span><span style="display:flex;"><span> }:{
</span></span><span style="display:flex;"><span>  delegations: subnetObject.delegations
</span></span><span style="display:flex;"><span> }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">var</span> natGateway = <span style="color:#a6e22e">empty</span>(subnetObject.natGateway) ? {
</span></span><span style="display:flex;"><span>}:{
</span></span><span style="display:flex;"><span>  natGateway: subnetObject.natGateway
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> networkSecurityGroup = <span style="color:#a6e22e">empty</span>(subnetObject.networkSecurityGroup) ? {
</span></span><span style="display:flex;"><span>}:{
</span></span><span style="display:flex;"><span>  networkSecurityGroup: subnetObject.networkSecurityGroup
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> privateEndpointNetworkPolicies = <span style="color:#a6e22e">empty</span>(subnetObject.privateEndpointNetworkPolicies) ? {
</span></span><span style="display:flex;"><span>}:{
</span></span><span style="display:flex;"><span>  privateEndpointNetworkPolicies: subnetObject.privateEndpointNetworkPolicies
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> privateLinkServiceNetworkPolicies = <span style="color:#a6e22e">empty</span>(subnetObject.privateLinkServiceNetworkPolicies) ? {
</span></span><span style="display:flex;"><span>}:{
</span></span><span style="display:flex;"><span>  privateLinkServiceNetworkPolicies: subnetObject.privateLinkServiceNetworkPolicies
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> routeTable = <span style="color:#a6e22e">empty</span>(subnetObject.routeTable) ? {
</span></span><span style="display:flex;"><span>}:{
</span></span><span style="display:flex;"><span>  routeTable: subnetObject.routeTable
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> serviceEndpointPolicies = <span style="color:#a6e22e">empty</span>(subnetObject.serviceEndpointPolicies) ? {
</span></span><span style="display:flex;"><span>}:{
</span></span><span style="display:flex;"><span>  serviceEndpointPolicies: subnetObject.serviceEndpointPolicies
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> serviceEndpoints = <span style="color:#a6e22e">empty</span>(subnetObject.serviceEndpoints) ? {
</span></span><span style="display:flex;"><span>}:{
</span></span><span style="display:flex;"><span>  serviceEndpoints: subnetObject.serviceEndpoints
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> newSubnetObject = {
</span></span><span style="display:flex;"><span>  name: subnetObject.name
</span></span><span style="display:flex;"><span>  properties: <span style="color:#a6e22e">union</span>(addressPrefix,delegations,natGateway,networkSecurityGroup,privateEndpointNetworkPolicies,privateLinkServiceNetworkPolicies,routeTable,serviceEndpointPolicies,serviceEndpoints)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//END: Build subnet object</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//START: output</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">output</span> subnet object = newSubnetObject
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//END: output</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span></code></pre></div>
<h3 id="templatearrayhelperbicep" data-numberify>templateArrayHelper.bicep<a class="anchor ms-1" href="#templatearrayhelperbicep"></a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Bicep" data-lang="Bicep"><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//START: parameters</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">param</span> array1 array = []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">param</span> array2 array = []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">param</span> array3 array = []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">param</span> array4 array = []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">param</span> array5 array = []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">param</span> array6 array = []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">param</span> array7 array = []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">param</span> array8 array = []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">param</span> array9 array = []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">param</span> array0 array = []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//END: parameters</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//START: variable</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> arrayunion = <span style="color:#a6e22e">union</span>(array0,array1,array2,array3,array4,array5,array6,array7,array8,array9)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//END: variable</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//START: Output</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">output</span> arrayunion array = arrayunion
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//END: Output</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span></code></pre></div>
<h3 id="deployps1" data-numberify>deploy.ps1<a class="anchor ms-1" href="#deployps1"></a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#66d9ef">try</span> 
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>    $ErrorActionPreference = <span style="color:#e6db74">&#34;Stop&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">###################################################</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#START: Team One</span>
</span></span><span style="display:flex;"><span>    $deploymentObject = &amp; .\parameters.ps1 -TeamName <span style="color:#e6db74">&#39;One&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    $resourceGroupDeploymentSplat = @{
</span></span><span style="display:flex;"><span>        Name = <span style="color:#e6db74">&#34;ericsDemoDeployment&#34;</span>
</span></span><span style="display:flex;"><span>        ResourceGroupName = <span style="color:#e6db74">&#34;eric-sandbox&#34;</span>
</span></span><span style="display:flex;"><span>        deploymentObject = $deploymentObject
</span></span><span style="display:flex;"><span>        TemplateFile = <span style="color:#e6db74">&#39;.\template.bicep&#39;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    New-AzResourceGroupDeployment @resourceGroupDeploymentSplat
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#END Team One</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">###################################################</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">###################################################</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#START: Team Two</span>
</span></span><span style="display:flex;"><span>    $deploymentObject = &amp; .\parameters.ps1 -TeamName <span style="color:#e6db74">&#39;Two&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    $resourceGroupDeploymentSplat = @{
</span></span><span style="display:flex;"><span>        Name = <span style="color:#e6db74">&#34;ericsDemoDeployment2&#34;</span>
</span></span><span style="display:flex;"><span>        ResourceGroupName = <span style="color:#e6db74">&#34;eric-sandbox&#34;</span>
</span></span><span style="display:flex;"><span>        deploymentObject = $deploymentObject
</span></span><span style="display:flex;"><span>        TemplateFile = <span style="color:#e6db74">&#39;.\template.bicep&#39;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    New-AzResourceGroupDeployment @resourceGroupDeploymentSplat
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#END Team Two</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">###################################################</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">catch</span> 
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>    $ExceptionObject = @(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;############################################&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;ExceptionMessage: &#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;</span>$($_.Exception.Message)<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;############################################&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Line: &#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;</span>$($_.InvocationInfo.ScriptLineNumber)<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;############################################&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;ScriptName: &#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;</span>$($_.InvocationInfo.ScriptName)<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;############################################&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Command: &#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;</span>$($_.InvocationInfo.MyCommand)<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;############################################&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;#Parameters (JSON): &#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;</span>$($_.InvocationInfo.BoundParameters | ConvertTo-Json -Depth <span style="color:#ae81ff">10</span>)<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Write-Host $($ExceptionObject | Out-String ) 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">Throw</span> $($ExceptionObject | Where-Object {$PSItem <span style="color:#f92672">-notlike</span> <span style="color:#e6db74">&#34;#*&#34;</span>} | Out-String)
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div>
<h2 id="demo-execution" data-numberify>Demo Execution<a class="anchor ms-1" href="#demo-execution"></a></h2>
<p>To run the demo, all we need to do is execute the deploy.ps1 file.  This can be accomplished by the following command.\</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>. .\deploy.ps1
</span></span></code></pre></div>
<h2 id="demo-result" data-numberify>Demo Result<a class="anchor ms-1" href="#demo-result"></a></h2>
<p>Upon completion of the script, here is what you&rsquo;ll see that is different.</p>
<ol>
<li>You will now have <strong>two</strong> virtual networks.</li>
<li>vnetOne is the same as it always was.  That is, it contains a custom DNS server and a set of subnets.</li>
<li>vnetTwo is slightly different than vnetOne.  vnetTwo does not have a custom DNS server, nor any subnets.</li>
<li>The template now has an output, this is so we can see the results of our conditional properties.</li>
<li>You&rsquo;ll notice that we were able to conditionally set subnets properties. The output for vNetOne subnet, only contain properties defined with values in the parameters.ps1.</li>
</ol>

<h3 id="demo-result-explanation" data-numberify>Demo Result Explanation<a class="anchor ms-1" href="#demo-result-explanation"></a></h3>
<p>To understand how I accomplished this, let&rsquo;s look at a few changes I made.</p>

<h4 id="parametersps1-changes" data-numberify>parameters.ps1 changes<a class="anchor ms-1" href="#parametersps1-changes"></a></h4>
<p>Like in part 3, we continued to simplify the parameters.ps1.</p>

<h5 id="parametersps1-subnet-changes" data-numberify>parameters.ps1 subnet changes<a class="anchor ms-1" href="#parametersps1-subnet-changes"></a></h5>
<p>Now the subnets themselves, only need property names defined, and do <strong>not</strong> need to mirror the official property schema.  Previously, we needed the subnets to match the schema of subnets bicep structure as detailed <a href="https://docs.microsoft.com/en-us/azure/templates/microsoft.network/virtualnetworks?pivots=deployment-language-bicep#subnet" target="_blank" rel="noopener noreferrer">here<i class="fas fa-external-link-square-alt ms-1"></i></a>.  Now you can craft your parameters however you like. The complexity of a well formed schema is moved to the helper template as you&rsquo;ll see further on.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#75715e">#########################################</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#START: GatewaySubnet</span>
</span></span><span style="display:flex;"><span>  @{
</span></span><span style="display:flex;"><span>  name = <span style="color:#e6db74">&#34;GatewaySubnet&#34;</span>
</span></span><span style="display:flex;"><span>  addressPrefix = <span style="color:#e6db74">&#34;</span>$($networkPrefix)<span style="color:#e6db74">.0.0/24&#34;</span>
</span></span><span style="display:flex;"><span>  applicationGatewayIpConfigurations = @()
</span></span><span style="display:flex;"><span>  delegations = @()
</span></span><span style="display:flex;"><span>  natGateway = @()
</span></span><span style="display:flex;"><span>  networkSecurityGroup = @{}
</span></span><span style="display:flex;"><span>  privateEndpointNetworkPolicies = <span style="color:#e6db74">&#34;Disabled&#34;</span>
</span></span><span style="display:flex;"><span>  privateLinkServiceNetworkPolicies = <span style="color:#e6db74">&#34;Disabled&#34;</span>
</span></span><span style="display:flex;"><span>  routeTable= @{}
</span></span><span style="display:flex;"><span>  serviceEndpointPolicies = @()
</span></span><span style="display:flex;"><span>  serviceEndpoints = @()
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#END: GatewaySubnet</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#########################################</span>
</span></span></code></pre></div>
<h4 id="generate-json-artifact-to-validate-this" data-numberify>Generate JSON artifact to validate this<a class="anchor ms-1" href="#generate-json-artifact-to-validate-this"></a></h4>
<p>Here is how we can validate that what is mentioned above, is in fact true.  Take a look specifically at TeamOne.  Notice how we have a number of defined properties which are empty.  This is something our helper modules is going to take care of.</p>

<h5 id="team-one" data-numberify>Team One<a class="anchor ms-1" href="#team-one"></a></h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span> . .\parameters.ps1 -TeamName <span style="color:#e6db74">&#34;one&#34;</span> | ConvertTo-Json -Depth <span style="color:#ae81ff">100</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;addressPrefixes&#34;</span>: [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;10.0.0.0/16&#34;</span>
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;subnets&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;serviceEndpoints&#34;</span>: [],
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;networkSecurityGroup&#34;</span>: {},
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;privateLinkServiceNetworkPolicies&#34;</span>: <span style="color:#e6db74">&#34;Disabled&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;routeTable&#34;</span>: {},
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;addressPrefix&#34;</span>: <span style="color:#e6db74">&#34;10.0.0.0/24&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;serviceEndpointPolicies&#34;</span>: [],
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;applicationGatewayIpConfigurations&#34;</span>: [],
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;privateEndpointNetworkPolicies&#34;</span>: <span style="color:#e6db74">&#34;Disabled&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;natGateway&#34;</span>: [],
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;GatewaySubnet&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;delegations&#34;</span>: []
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;serviceEndpoints&#34;</span>: [],
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;networkSecurityGroup&#34;</span>: {},
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;privateLinkServiceNetworkPolicies&#34;</span>: <span style="color:#e6db74">&#34;Disabled&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;routeTable&#34;</span>: {},
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;addressPrefix&#34;</span>: <span style="color:#e6db74">&#34;10.0.10.0/24&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;serviceEndpointPolicies&#34;</span>: [],
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;applicationGatewayIpConfigurations&#34;</span>: [],
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;privateEndpointNetworkPolicies&#34;</span>: <span style="color:#e6db74">&#34;Disabled&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;natGateway&#34;</span>: {},
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;webFarm1&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;delegations&#34;</span>: [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Microsoft.Web/serverFarms&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;properties&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;serviceName&#34;</span>: <span style="color:#e6db74">&#34;Microsoft.Web/serverFarms&#34;</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      ]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;enableVmProtection&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;enableDdosProtection&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;dhcpOptions&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;dnsServers&#34;</span>: [
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;8.8.8.8&#34;</span>
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;vnetone&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;virtualNetworkPeerings&#34;</span>: [],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;tags&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;environment&#34;</span>: <span style="color:#e6db74">&#34;sandbox&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
<h5 id="team-two" data-numberify>Team Two<a class="anchor ms-1" href="#team-two"></a></h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span> . .\parameters.ps1 -TeamName <span style="color:#e6db74">&#34;two&#34;</span> | ConvertTo-Json -Depth <span style="color:#ae81ff">100</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;addressPrefixes&#34;</span>: [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;10.0.0.0/16&#34;</span>
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;vnettwo&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;enableVmProtection&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;virtualNetworkPeerings&#34;</span>: [],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;tags&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;environment&#34;</span>: <span style="color:#e6db74">&#34;sandbox&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;enableDdosProtection&#34;</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
<h4 id="templatebicep-changes" data-numberify>template.bicep changes<a class="anchor ms-1" href="#templatebicep-changes"></a></h4>
<p>As with part 3, we continue to move more of the complexity into the Bicep templates.</p>

<h5 id="adding-a-new-section-to-deal-with-subnets" data-numberify>Adding a new section to deal with subnets<a class="anchor ms-1" href="#adding-a-new-section-to-deal-with-subnets"></a></h5>
<p>We now have a section which offloads the subnet evaluation work to a whole other Bicep module.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Bicep" data-lang="Bicep"><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//START: conditionally build subnets</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> subnetsPropertyDefined = <span style="color:#a6e22e">contains</span>(deploymentObject, <span style="color:#e6db74">&#39;subnets&#39;</span>) <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span> ? <span style="color:#66d9ef">true</span> : <span style="color:#66d9ef">false</span> <span style="color:#75715e">//make sure there is even a subnet property defined</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> subnetsExistToBeDeploy = subnetsPropertyDefined <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span> ? <span style="color:#a6e22e">empty</span>(deploymentObject.subnets) <span style="color:#f92672">==</span> <span style="color:#66d9ef">false</span> : <span style="color:#66d9ef">false</span> <span style="color:#75715e">//make sure we have subnets defined and that it&#39;s not just an empty array</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> subnetsToDeploy = subnetsExistToBeDeploy <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span> ? deploymentObject.subnets : [] <span style="color:#75715e">// use the defined subnets, or create an empty array</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//If the array has subnets, we&#39;ll loop through them and have a helper module process them.  Otherwise, if the array is empty, this will ultimately not run.  (not items to loop through)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">module</span> mod_allSubnets <span style="color:#e6db74">&#39;templateSubnetHelper.bicep&#39;</span> = [<span style="color:#66d9ef">for</span> subnet <span style="color:#66d9ef">in</span> subnetsToDeploy: <span style="color:#a6e22e">if</span>(subnetsExistToBeDeploy <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>  name: <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">uniqueString</span>(deploymentObject.name)<span style="color:#e6db74">}</span><span style="color:#e6db74">_</span><span style="color:#e6db74">${</span>subnet.name<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>  params:{
</span></span><span style="display:flex;"><span>    subnetObject: subnet
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//We have an array or arrays, and it&#39;s a pain to parse looped outputs in Bicep.  Rather than trying to do something to complex, we send it to another helper module to &#34;union&#34; the arrays.  </span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">module</span> mod_arrayHelper <span style="color:#e6db74">&#39;templateArrayHelper.bicep&#39;</span> = <span style="color:#a6e22e">if</span>(subnetsExistToBeDeploy <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>  name: <span style="color:#e6db74">&#39;arrayHelper_</span><span style="color:#e6db74">${</span>deploymentObject.name<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>  params:{
</span></span><span style="display:flex;"><span>    array0: [<span style="color:#66d9ef">for</span> (subnetName, index) <span style="color:#66d9ef">in</span> subnetsToDeploy: mod_allSubnets[index].outputs.subnet ]
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//END: conditionally build subnets</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">////////////////////////////////////////</span>
</span></span></code></pre></div><p>Now to explain what is going on.</p>
<p>To avoid errors in the deployment, we first need to see if any <strong>subnet</strong> property has been defined at all.  We&rsquo;ll do this with the contains object.  If the property exits, it will return true, other wise false.  We&rsquo;ll use this value in the next evaluation.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Bicep" data-lang="Bicep"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> subnetsPropertyDefined = <span style="color:#a6e22e">contains</span>(deploymentObject, <span style="color:#e6db74">&#39;subnets&#39;</span>) <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span> ? <span style="color:#66d9ef">true</span> : <span style="color:#66d9ef">false</span>
</span></span></code></pre></div><p>We now know whether there is a subnet properties defined or not.  Thanks to the &ldquo;subnetPropertiesDefined&rdquo; var.  Now we need to determine if there is any values.  If we have values, again, we set a boolean value of true otherwise false.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Bicep" data-lang="Bicep"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> subnetsExistToBeDeploy = subnetsPropertyDefined <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span> ? <span style="color:#a6e22e">empty</span>(deploymentObject.subnets) <span style="color:#f92672">==</span> <span style="color:#66d9ef">false</span> : <span style="color:#66d9ef">false</span>
</span></span></code></pre></div><p>If subnetsExistToDeploy is true, we now know that we have a subnet object to deploy.  We can now use this value to setup either a var with an empty array or a var with the subnets you want to deploy.  The reason we do this is because Bicep doesn&rsquo;t handle conditions + loops very well.  At least there are a lot of limitations.  With an empty array, Bicep will effectively skip the module because there is nothing to loop through.  Therefor, it&rsquo;s essentially making it a conditional deployment.  You can use this tactic with any property that is based on an array.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Bicep" data-lang="Bicep"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> subnetsToDeploy = subnetsExistToBeDeploy <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span> ? deploymentObject.subnets : []
</span></span></code></pre></div><p>Now, we&rsquo;ll loop through all the subnets and determine if anything needs to be conditionally deployed.  If a subnet exists, we&rsquo;ll send it our help module (more on that later).  We&rsquo;re using a module because this is the only way that we can do loops with conditions in Bicep.  Looking at this code now, I suspect we don&rsquo;t even need the condition statement since an empty array will do nothing.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Bicep" data-lang="Bicep"><span style="display:flex;"><span><span style="color:#66d9ef">module</span> mod_allSubnets <span style="color:#e6db74">&#39;templateSubnetHelper.bicep&#39;</span> = [<span style="color:#66d9ef">for</span> subnet <span style="color:#66d9ef">in</span> subnetsToDeploy: <span style="color:#a6e22e">if</span>(subnetsExistToBeDeploy <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>  name: <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">uniqueString</span>(deploymentObject.name)<span style="color:#e6db74">}</span><span style="color:#e6db74">_</span><span style="color:#e6db74">${</span>subnet.name<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>  params:{
</span></span><span style="display:flex;"><span>    subnetObject: subnet
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}]
</span></span></code></pre></div><p>The results of the subnet helper module will be an array of objects. This next part is to simply make things easier for us.  How?  Well Bicep has a lot of loop limits, and one of those with consuming the output of a Bicep module that was the result of a loop its self.  One way to get around this, is to use yet another module, but this time, <strong>not</strong> doing any loops.  Instead, we put the data in to a generic module that does nothing more than union an array and spit an array back out.  Since the module in this case is not a loop, we can directly reference the output.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Bicep" data-lang="Bicep"><span style="display:flex;"><span><span style="color:#66d9ef">module</span> mod_arrayHelper <span style="color:#e6db74">&#39;templateArrayHelper.bicep&#39;</span> = <span style="color:#a6e22e">if</span>(subnetsExistToBeDeploy <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>  name: <span style="color:#e6db74">&#39;arrayHelper_</span><span style="color:#e6db74">${</span>deploymentObject.name<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>  params:{
</span></span><span style="display:flex;"><span>    array0: [<span style="color:#66d9ef">for</span> (subnetName, index) <span style="color:#66d9ef">in</span> subnetsToDeploy: mod_allSubnets[index].outputs.subnet ]
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>As an aside, here is what kind of error might you get if you didn&rsquo;t use the array module.  For example, if your variable looks like this.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Bicep" data-lang="Bicep"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> subnets = subnetsExistToBeDeploy <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span> ? [<span style="color:#66d9ef">for</span> (subnetName, index) <span style="color:#66d9ef">in</span> subnetsToDeploy: mod_allSubnets[index].outputs.subnet ] : {}
</span></span></code></pre></div><p>Then you can expect to see an error message like the one below.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">owner</span>: <span style="color:#e6db74">&#34;_generated_diagnostic_collection_name_#1&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#f92672">code</span>: <span style="color:#e6db74">&#34;BCP138&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#f92672">message</span>: <span style="color:#e6db74">&#34;For-expressions are not supported in this context. For-expressions may be used as values of resource, module, variable, and output declarations, or values of resource and module properties.&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#f92672">source</span>: <span style="color:#e6db74">&#34;bicep&#34;</span>
</span></span></code></pre></div><p>The final difference in the main bicep file is just a tweak of the original conditional property for the subnet.  You can see here that we again check if there is a subnet to deploy and if so, we are able to directly reference the output of the helper array module.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Bicep" data-lang="Bicep"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> subnets = subnetsExistToBeDeploy <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span> ? {subnets: mod_arrayHelper.outputs.arrayunion } : {}
</span></span></code></pre></div>
<h4 id="templatesubnethelperbicep-explication" data-numberify>templateSubnetHelper.bicep explication<a class="anchor ms-1" href="#templatesubnethelperbicep-explication"></a></h4>
<p>The subnet helper bicep template actually doesn&rsquo;t need a a lot of explanation.  It works very much like the way our evaluation variables worked in part 3 (and still work in part 4).  But let&rsquo;s break it down into a few steps.</p>
<ol>
<li>We are only sending a subnet object that we know has data.  Those evaluations were done ahead of time, thanks to conditional variables we explained starting <a href="/azure-bicep-conditional-properties-part-04-helper-modules/#adding-a-new-section-to-deal-with-subnets">here</a></li>
<li>The module is used to send a single subnet object into the template.  This allows us to process a nested object and implement conditional properties.  You can mostly follow this method as deep as you need, within the constraints of Bicep. Meaning, if you have multiple levels of nesting, you&rsquo;ll likely need multiple helper modules to conditionally join things together.  To restate, this is an issue when we&rsquo;re dealing with nested objects that are in arrays.  This is not an issue with nested standalone object and can be accomplished without a helper module.</li>
<li>For each subnet submitted, we evaluate if it contains any of the available properties.  if it does, we create a variable which contains the property name and it&rsquo;s value.  Otherwise we create a blank object.  See below as an example.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Bicep" data-lang="Bicep"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> privateLinkServiceNetworkPolicies = <span style="color:#a6e22e">empty</span>(subnetObject.privateLinkServiceNetworkPolicies) ? {
</span></span><span style="display:flex;"><span>}:{
</span></span><span style="display:flex;"><span>  privateLinkServiceNetworkPolicies: subnetObject.privateLinkServiceNetworkPolicies
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ol start="4">
<li>Once all the property evaluations are complete, we utilize the <a href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/templates/template-functions-object#union" target="_blank" rel="noopener noreferrer">union function<i class="fas fa-external-link-square-alt ms-1"></i></a> to join them together as a single object again.</li>
<li>Finally we output them back to the module so they can be consumed by the main template.</li>
</ol>

<h4 id="templatearrayhelperbicep-explication" data-numberify>templateArrayHelper.bicep explication<a class="anchor ms-1" href="#templatearrayhelperbicep-explication"></a></h4>
<p>Again, very similar to the above point, we&rsquo;ve create a generic array helper that will allow us to join together what is already an array.  The problem as mentioned above, is Bicep has some real weird limitation.  Since we can&rsquo;t conditionally loop in a variable, we want to first create a variable that contains all the values we want.  That is the point of the array module.  We use it to conditionally create a single array of data that we can directly reference.</p>

<h4 id="the-results" data-numberify>The results<a class="anchor ms-1" href="#the-results"></a></h4>
<p>Once you&rsquo;ve deployed the two virtual networks, you should see the following outputs available.</p>

<h5 id="vnetone-output" data-numberify>vNetOne Output<a class="anchor ms-1" href="#vnetone-output"></a></h5>
<p>Remember when I mentioned to keep an eye on team ones vnet?  Remember how it had a bunch of empty properties specified?  Below, you can see that other than peerings properties, all empty properties have been filtered out.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;addressSpace&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;addressPrefixes&#34;</span>: [
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;10.0.0.0/16&#34;</span>
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;dhcpOptions&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;dnsServers&#34;</span>: [
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;8.8.8.8&#34;</span>
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;subnets&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;GatewaySubnet&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;properties&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;addressPrefix&#34;</span>: <span style="color:#e6db74">&#34;10.0.0.0/24&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;privateEndpointNetworkPolicies&#34;</span>: <span style="color:#e6db74">&#34;Disabled&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;privateLinkServiceNetworkPolicies&#34;</span>: <span style="color:#e6db74">&#34;Disabled&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;webFarm1&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;properties&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;addressPrefix&#34;</span>: <span style="color:#e6db74">&#34;10.0.10.0/24&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;delegations&#34;</span>: [
</span></span><span style="display:flex;"><span>          {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Microsoft.Web/serverFarms&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;properties&#34;</span>: {
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;serviceName&#34;</span>: <span style="color:#e6db74">&#34;Microsoft.Web/serverFarms&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>        ],
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;privateEndpointNetworkPolicies&#34;</span>: <span style="color:#e6db74">&#34;Disabled&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;privateLinkServiceNetworkPolicies&#34;</span>: <span style="color:#e6db74">&#34;Disabled&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;enableDdosProtection&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;enableVmProtection&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;virtualNetworkPeerings&#34;</span>: []
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
<h5 id="vnettwo-output" data-numberify>vNetTwo Output<a class="anchor ms-1" href="#vnettwo-output"></a></h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;addressSpace&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;addressPrefixes&#34;</span>: [
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;10.0.0.0/16&#34;</span>
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;enableDdosProtection&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;enableVmProtection&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;virtualNetworkPeerings&#34;</span>: []
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
<h2 id="article-conclusion" data-numberify>Article Conclusion<a class="anchor ms-1" href="#article-conclusion"></a></h2>
<p>In this article we touched on dealing with nested conditional properties.  It&rsquo;s a tad more convoluted for sure, but 100% doable if you want to keep the complexity in the template instead of your parameters.</p>
</div>
</div>
</div><div class="card-footer">
  <div class="post-navs d-flex justify-content-evenly"><div class="post-nav post-prev">
      <i class="fas fa-fw fa-chevron-down post-prev-icon me-1" data-fa-transform="rotate-90"></i>
      <a href="/azure-bicep-conditional-properties-part-03-template-variables/">Azure Bicep Conditional Properties Part 03, Template Variables</a>
    </div><div class="post-nav post-next">
      <a href="/problem-solving-windows-dns-server-in-azure-returns-servfail/">Problem Solving: Windows DNS Server in Azure returns SERVFAIL</a>
      <i class="fas fa-fw fa-chevron-down post-next-icon ms-1" data-fa-transform="rotate-270"></i>
    </div></div>
</div></article><div class="post-copyright mb-3 row card component" id="post-copyright">
    <div class="card-header">
        <h2 class="card-title fs-4 my-2 text-surface">Copyright</h2>
    </div>
    <div class="card-body"><a class="d-flex align-items-center flex-column" target="_blank" rel="license noopener noreferrer" href="https://creativecommons.org/licenses/by-sa/4.0/deed.en">
  <span><i class="fab fa-fw fa-2x fa-creative-commons"></i><i class="fab fa-fw fa-2x fa-creative-commons-by"></i><i class="fab fa-fw fa-2x fa-creative-commons-sa"></i></span>
  CC BY-SA 4.0 
</a>


    </div>
</div><section class="related-posts row card component">
      <div class="card-header">
        <h2 class="card-title fs-4 my-2 text-surface">
          Related Posts
        </h2>
      </div>
      <div class="card-body slide px-1">
        <div class="slide-inner row gx-0"><div class="col-12 col-md-6 col-lg-4 me-2">
            <div class="post-card card card-body p-0 border-0 surface">
  
  <div
    class="post-card-default-img card-img-top d-flex align-items-center justify-content-center bg-body-secondary mb-1">
    NO IMAGE
  </div>

  <a class="post-title" href="/azure-bicep-conditional-properties-part-03-template-variables/">
    Azure Bicep Conditional Properties Part 03, Template Variables
  </a>
  <div class="post-meta mb-0">
    Sun, 28 Aug 2022 12:00:00 &#43;0000

  </div>
</div>

          </div><div class="col-12 col-md-6 col-lg-4 me-2">
            <div class="post-card card card-body p-0 border-0 surface">
  
  <div
    class="post-card-default-img card-img-top d-flex align-items-center justify-content-center bg-body-secondary mb-1">
    NO IMAGE
  </div>

  <a class="post-title" href="/azure-bicep-conditional-properties-part-02-parameters/">
    Azure Bicep Conditional Properties Part 02, Parameters
  </a>
  <div class="post-meta mb-0">
    Sun, 21 Aug 2022 13:00:00 &#43;0000

  </div>
</div>

          </div><div class="col-12 col-md-6 col-lg-4 me-2">
            <div class="post-card card card-body p-0 border-0 surface">
  
  <div
    class="post-card-default-img card-img-top d-flex align-items-center justify-content-center bg-body-secondary mb-1">
    NO IMAGE
  </div>

  <a class="post-title" href="/azure-bicep-conditional-properties-part-01-introduction/">
    Azure Bicep Conditional Properties Part 01, Introduction
  </a>
  <div class="post-meta mb-0">
    Sun, 21 Aug 2022 12:00:00 &#43;0000

  </div>
</div>

          </div><div class="col-12 col-md-6 col-lg-4 me-2">
            <div class="post-card card card-body p-0 border-0 surface">
  
  <div
    class="post-card-default-img card-img-top d-flex align-items-center justify-content-center bg-body-secondary mb-1">
    NO IMAGE
  </div>

  <a class="post-title" href="/iac-creativity-introduction/">
    IaC Creativity: Introduction
  </a>
  <div class="post-meta mb-0">
    Fri, 05 Mar 2021 12:00:00 &#43;0500

  </div>
</div>

          </div><div class="col-12 col-md-6 col-lg-4 me-2">
            <div class="post-card card card-body p-0 border-0 surface">
  
  <div
    class="post-card-default-img card-img-top d-flex align-items-center justify-content-center bg-body-secondary mb-1">
    NO IMAGE
  </div>

  <a class="post-title" href="/quicky-review-gpo/gpp-vs.-dsc/">
    Quicky Review: GPO/GPP vs. DSC
  </a>
  <div class="post-meta mb-0">
    Sun, 18 Sep 2016 16:10:12 &#43;0000

  </div>
</div>

          </div></div>
        <button class="slide-control-left">
          <i class="fas fa-2x fa-chevron-circle-down" data-fa-transform="rotate-90"></i>
          <span class="visually-hidden">Left</span>
        </button>
        <button class="slide-control-right">
          <i class="fas fa-2x fa-chevron-circle-down" data-fa-transform="rotate-270"></i>
          <span class="visually-hidden">Right</span>
        </button>
      </div>
    </section><div class="card component row post-comments" id="post-comments">
  <div class="card-header">
    <h2 class="card-title my-2 fs-4 text-surface">Comments</h2>
  </div>
  <div class="card-body"><script src="https://utteranc.es/client.js"
  repo="ericcsinger/ericcsinger.github.io"
  issue-term="title"
  label="comment"
  theme="github-light"
  crossorigin="anonymous"
  async>
</script>



</div>
</div></div>
</div>
<aside class="col-xxl-4 sidebar d-flex">
  <div class="container d-flex flex-column">
    
    
<div class="accordion profile">
  <div class="accordion-item card row text-center component">
    <div class="accordion-header card-header border-0" id="profile-header">
      <a
        class="accordion-button d-lg-none mb-2 shadow-none p-0 bg-transparent text-surface"
        role="button" data-bs-toggle="collapse" href="#profile" aria-expanded="true" aria-controls="profile">
        Profile
      </a>
    </div>
    <div class="card-body collapse accordion-collapse accordion-body d-lg-block show" id="profile" aria-labelledby="profile-header">
      <div class="col-12 d-flex align-items-center justify-content-center"><picture><img class="profile-avatar rounded-circle " alt="Eric C. Singer" src="https://ericcsinger.com/about/headshot.webp?v=474438880c076aa6bcfa6a5e9186211d" loading="lazy" data-viewer-invisible width="2316" height="3088" />
</picture>
</div>
      <div class="col-12 profile-meta"><div class="profile-name fw-fold fs-lg">Eric C. Singer</div><div class="profile-bio">An enthusiastic IT professional, focused on designing and automating infrastructure since 2002.</div><div class="profile-location"><i class="fas fa-fw fa-map-marker-alt"></i>Quakertown, PA</div><a class="profile-about text-primary" href="/about/"><i class="fas fa-fw fa-user"></i>About Me</a></div></div>
  </div>
</div>


<div class="accordion taxonomies-toggle">
    <div class="row card component accordion-item">
        <div class="accordion-header card-header border-0">
            <a
                class="accordion-button d-lg-none mb-1 shadow-none p-0 bg-transparent"
                role="button" data-bs-toggle="collapse" href="#taxonomies-toggle" aria-expanded="true" aria-controls="taxonomies-toggle">
                Taxonomies
            </a>
        </div>
        <div class="card-body collapse accordion-collapse accordion-body d-lg-block show" id="taxonomies-toggle">
            <ul class="nav nav-pills nav-fill" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="taxonomyTagsTab" data-bs-toggle="tab" data-bs-target="#taxonomyTags" 
                            type="button" role="tab" aria-controls="taxonomyTags" aria-selected="true">
                            Tags
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="taxonomyCategoriesTab" data-bs-toggle="tab" data-bs-target="#taxonomyCategories" 
                            type="button" role="tab" aria-controls="taxonomyCategories" aria-selected="true">
                            Categories
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="taxonomySeriesTab" data-bs-toggle="tab" data-bs-target="#taxonomySeries" 
                            type="button" role="tab" aria-controls="taxonomySeries" aria-selected="true">
                            Series
                        </button>
                    </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="taxonomyArchivesTab" data-bs-toggle="tab" data-bs-target="#taxonomyArchives" 
                        type="button" role="tab" aria-controls="taxonomyArchives" aria-selected="true">
                        Archives
                    </button>
                </li>
            </ul>
            
            <div class="tab-content mt-3">
                    <div class="tab-pane active" id="taxonomyTags" role="tabpanel" aria-labelledby="taxonomyTagsTab" tabindex="0">
                        <a href="/tags/powershell/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Powershell">
                            Powershell
                            <span class="badge badge-sm text-secondary bg-white ms-1">19</span>
                        </a>
                        <a href="/tags/azure/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Azure">
                            Azure
                            <span class="badge badge-sm text-secondary bg-white ms-1">9</span>
                        </a>
                        <a href="/tags/microsoft/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Microsoft">
                            Microsoft
                            <span class="badge badge-sm text-secondary bg-white ms-1">9</span>
                        </a>
                        <a href="/tags/automation/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Automation">
                            Automation
                            <span class="badge badge-sm text-secondary bg-white ms-1">7</span>
                        </a>
                        <a href="/tags/backup/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Backup">
                            Backup
                            <span class="badge badge-sm text-secondary bg-white ms-1">7</span>
                        </a>
                        <a href="/tags/sql/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="SQL">
                            SQL
                            <span class="badge badge-sm text-secondary bg-white ms-1">6</span>
                        </a>
                        <a href="/tags/storage/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Storage">
                            Storage
                            <span class="badge badge-sm text-secondary bg-white ms-1">6</span>
                        </a>
                        <a href="/tags/vmware/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Vmware">
                            Vmware
                            <span class="badge badge-sm text-secondary bg-white ms-1">6</span>
                        </a>
                        <a href="/tags/wsus/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Wsus">
                            Wsus
                            <span class="badge badge-sm text-secondary bg-white ms-1">6</span>
                        </a>
                        <a href="/tags/arm/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Arm">
                            Arm
                            <span class="badge badge-sm text-secondary bg-white ms-1">5</span>
                        </a>
                        <a href="/tags/bicep/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Bicep">
                            Bicep
                            <span class="badge badge-sm text-secondary bg-white ms-1">5</span>
                        </a>
                        <a href="/tags/iac/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="IaC">
                            IaC
                            <span class="badge badge-sm text-secondary bg-white ms-1">5</span>
                        </a>
                        <a href="/tags/thinking-out-loud/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Thinking Out Loud">
                            Thinking Out Loud
                            <span class="badge badge-sm text-secondary bg-white ms-1">5</span>
                        </a>
                        <a href="/tags/naming-conventions/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Naming Conventions">
                            Naming Conventions
                            <span class="badge badge-sm text-secondary bg-white ms-1">4</span>
                        </a>
                        <a href="/tags/review/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Review">
                            Review
                            <span class="badge badge-sm text-secondary bg-white ms-1">4</span>
                        </a>
                        <a href="/tags/windows/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Windows">
                            Windows
                            <span class="badge badge-sm text-secondary bg-white ms-1">4</span>
                        </a>
                        <a href="/tags/active-directory/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Active Directory">
                            Active Directory
                            <span class="badge badge-sm text-secondary bg-white ms-1">3</span>
                        </a>
                        <a href="/tags/cloud/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Cloud">
                            Cloud
                            <span class="badge badge-sm text-secondary bg-white ms-1">3</span>
                        </a>
                        <a href="/tags/commvault/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Commvault">
                            Commvault
                            <span class="badge badge-sm text-secondary bg-white ms-1">3</span>
                        </a>
                        <a href="/tags/jams/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="JAMS">
                            JAMS
                            <span class="badge badge-sm text-secondary bg-white ms-1">3</span>
                        </a>
                        <a href="/tags/nimble-storage/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Nimble Storage">
                            Nimble Storage
                            <span class="badge badge-sm text-secondary bg-white ms-1">3</span>
                        </a>
                        <a href="/tags/reviews/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Reviews">
                            Reviews
                            <span class="badge badge-sm text-secondary bg-white ms-1">3</span>
                        </a>
                        <a href="/tags/scripting/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Scripting">
                            Scripting
                            <span class="badge badge-sm text-secondary bg-white ms-1">3</span>
                        </a>
                        <a href="/tags/t-sql/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="T-SQL">
                            T-SQL
                            <span class="badge badge-sm text-secondary bg-white ms-1">3</span>
                        </a>
                        <a href="/tags/centralized-job-management/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Centralized Job Management">
                            Centralized Job Management
                            <span class="badge badge-sm text-secondary bg-white ms-1">2</span>
                        </a>
                        <a href="https://ericcsinger.com/tags" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title='ALL'>
                        ALL
                        <span class="badge badge-sm text-secondary bg-white ms-1">67</span>
                        </a>
                    </div>
                    <div class="tab-pane" id="taxonomyCategories" role="tabpanel" aria-labelledby="taxonomyCategoriesTab" tabindex="0">
                        <a href="/categories/uncategorized/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title="Uncategorized">
                            Uncategorized
                            <span class="badge badge-sm text-secondary bg-white ms-1">48</span>
                        </a>
                        <a href="/categories/backup/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title="Backup">
                            Backup
                            <span class="badge badge-sm text-secondary bg-white ms-1">6</span>
                        </a>
                        <a href="/categories/storage/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title="Storage">
                            Storage
                            <span class="badge badge-sm text-secondary bg-white ms-1">4</span>
                        </a>
                        <a href="/categories/thinking-out-loud/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title="Thinking Out Loud">
                            Thinking Out Loud
                            <span class="badge badge-sm text-secondary bg-white ms-1">4</span>
                        </a>
                        <a href="/categories/naming-conventions/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title="Naming Conventions">
                            Naming Conventions
                            <span class="badge badge-sm text-secondary bg-white ms-1">3</span>
                        </a>
                        <a href="/categories/cloud/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title="Cloud">
                            Cloud
                            <span class="badge badge-sm text-secondary bg-white ms-1">1</span>
                        </a>
                        <a href="/categories/licensing/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title="Licensing">
                            Licensing
                            <span class="badge badge-sm text-secondary bg-white ms-1">1</span>
                        </a>
                        <a href="/categories/monitoring/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title="Monitoring">
                            Monitoring
                            <span class="badge badge-sm text-secondary bg-white ms-1">1</span>
                        </a>
                        <a href="/categories/servers/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title="Servers">
                            Servers
                            <span class="badge badge-sm text-secondary bg-white ms-1">1</span>
                        </a>
                    </div>
                    <div class="tab-pane" id="taxonomySeries" role="tabpanel" aria-labelledby="taxonomySeriesTab" tabindex="0">
                        <a href="/series/backup-storage/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-series me-2 mb-2" title="Backup Storage">
                            Backup Storage
                            <span class="badge badge-sm text-secondary bg-white ms-1">8</span>
                        </a>
                        <a href="/series/azure-bicep-conditional-properties/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-series me-2 mb-2" title="Azure Bicep Conditional Properties">
                            Azure Bicep Conditional Properties
                            <span class="badge badge-sm text-secondary bg-white ms-1">4</span>
                        </a>
                    </div>
                <div class="tab-pane" id="taxonomyArchives" role="tabpanel" aria-labelledby="taxonomyArchivesTab" tabindex="0">

    <a href="" class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title="2024">
    2024 <span class="badge badge-sm text-secondary bg-white ms-1">1</span>
    </a>

    <a href="" class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title="2023">
    2023 <span class="badge badge-sm text-secondary bg-white ms-1">1</span>
    </a>

    <a href="" class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title="2022">
    2022 <span class="badge badge-sm text-secondary bg-white ms-1">6</span>
    </a>

    <a href="" class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title="2021">
    2021 <span class="badge badge-sm text-secondary bg-white ms-1">3</span>
    </a>

    <a href="" class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title="2020">
    2020 <span class="badge badge-sm text-secondary bg-white ms-1">4</span>
    </a>

    <a href="" class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title="2019">
    2019 <span class="badge badge-sm text-secondary bg-white ms-1">7</span>
    </a>

    <a href="" class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title="2018">
    2018 <span class="badge badge-sm text-secondary bg-white ms-1">7</span>
    </a>

    <a href="" class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title="2017">
    2017 <span class="badge badge-sm text-secondary bg-white ms-1">17</span>
    </a>

    <a href="" class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title="2016">
    2016 <span class="badge badge-sm text-secondary bg-white ms-1">17</span>
    </a>

    <a href="" class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title="2015">
    2015 <span class="badge badge-sm text-secondary bg-white ms-1">16</span>
    </a>


                </div>
            </div>
        </div>
    </div>
</div>
    <div class="accordion posts-toggle">
      <div class="row card component accordion-item">
        <div class="accordion-header card-header border-0">
          <a
            class="accordion-button d-lg-none mb-1 shadow-none p-0 bg-transparent"
            role="button"
            data-bs-toggle="collapse"
            href="#posts-toggle"
            aria-expanded="true"
            aria-controls="posts-toggle">
            Posts
          </a>
        </div>
        <div
          class="card-body collapse accordion-collapse accordion-body d-lg-block show"
          id="posts-toggle">
          <ul class="nav nav-pills nav-fill" role="tablist">
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link active"
                  id="recent-posts-tab"
                  data-bs-toggle="tab"
                  data-bs-target="#recent-posts"
                  type="button"
                  role="tab"
                  aria-controls="recent-posts"
                  aria-selected="true">
                  Recent Posts
                </button>
              </li>
          </ul>

          <div class="tab-content mt-3">
              <div
                class="tab-pane active"
                id="recent-posts"
                role="tabpanel"
                aria-labelledby="recent-posts-tab"
                tabindex="0">
                <ul class="post-list list-unstyled ms-1">
                    <li class="mb-2">
  <div class="d-flex">
    <div
      class="flex-grow-1 d-flex flex-column h-auto justify-content-center">
      <a class="post-title" href="/thinking-out-loud-shared-vs.-dedicated-infrastructure/">
        Thinking out loud: Shared vs. Dedicated Infrastructure
      </a>
      <div class="post-meta mt-2">
        <span class="post-date">
          Sun, 23 Jun 2024 12:00:00 &#43;0000
        </span>
      </div>
    </div>
  </div>
                    </li>
                    <li class="mb-2">
  <div class="d-flex">
    <div
      class="flex-grow-1 d-flex flex-column h-auto justify-content-center">
      <a class="post-title" href="/pgadmin-azure-ad-authentication-token-renewal/">
        PGAdmin Azure AD Authentication Token Renewal
      </a>
      <div class="post-meta mt-2">
        <span class="post-date">
          Sat, 24 Jun 2023 12:00:00 &#43;0000
        </span>
      </div>
    </div>
  </div>
                    </li>
                    <li class="mb-2">
  <div class="d-flex">
    <div
      class="flex-grow-1 d-flex flex-column h-auto justify-content-center">
      <a class="post-title" href="/naming-conventions-azure-locations/">
        Naming Conventions: Azure Locations
      </a>
      <div class="post-meta mt-2">
        <span class="post-date">
          Sun, 30 Oct 2022 12:00:00 &#43;0000
        </span>
      </div>
    </div>
  </div>
                    </li>
                    <li class="mb-2">
  <div class="d-flex">
    <div
      class="flex-grow-1 d-flex flex-column h-auto justify-content-center">
      <a class="post-title" href="/problem-solving-windows-dns-server-in-azure-returns-servfail/">
        Problem Solving: Windows DNS Server in Azure returns SERVFAIL
      </a>
      <div class="post-meta mt-2">
        <span class="post-date">
          Sat, 24 Sep 2022 12:00:00 &#43;0000
        </span>
      </div>
    </div>
  </div>
                    </li>
                    <li class="mb-2">
  <div class="d-flex">
    <div
      class="flex-grow-1 d-flex flex-column h-auto justify-content-center">
      <a class="post-title" href="/azure-bicep-conditional-properties-part-04-helper-modules/">
        Azure Bicep Conditional Properties Part 04, Helper Modules
      </a>
      <div class="post-meta mt-2">
        <span class="post-date">
          Sat, 10 Sep 2022 12:00:00 &#43;0000
        </span>
      </div>
    </div>
  </div>
                    </li>
                </ul>
              </div>
          </div>
        </div>
      </div>
    </div>
<div class="accordion post-toc d-none d-lg-block">
  <div class="accordion-item row mb-4 card component" id="postTOC">
    <div class="card-header accordion-header">
      <h2 class="card-title fs-4 my-2 text-surface d-none d-lg-block">Contents</h2>
      <a class="accordion-button d-lg-none mb-1 collapsed shadow-none p-0 bg-transparent" role="button" data-bs-toggle="collapse" href="#post-toc" aria-expanded="false" aria-controls="post-toc">
        Contents
      </a>
    </div>
    <div class="card-body collapse accordion-collapse accordion-body d-lg-block" id="post-toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#series-introduction">Series Introduction</a>
      <ul>
        <li><a href="#series-index">Series Index</a></li>
        <li><a href="#series-demo-setup">Series Demo Setup</a></li>
      </ul>
    </li>
    <li><a href="#article-introduction">Article Introduction</a></li>
    <li><a href="#article-demo-setup">Article Demo Setup</a>
      <ul>
        <li><a href="#parametersps1">parameters.ps1</a></li>
        <li><a href="#templatebicep">template.bicep</a></li>
        <li><a href="#templatesubnethelperbicep">templateSubnetHelper.bicep</a></li>
        <li><a href="#templatearrayhelperbicep">templateArrayHelper.bicep</a></li>
        <li><a href="#deployps1">deploy.ps1</a></li>
      </ul>
    </li>
    <li><a href="#demo-execution">Demo Execution</a></li>
    <li><a href="#demo-result">Demo Result</a>
      <ul>
        <li><a href="#demo-result-explanation">Demo Result Explanation</a></li>
      </ul>
    </li>
    <li><a href="#article-conclusion">Article Conclusion</a></li>
  </ul>
</nav>
    </div>
  </div>
</div>





    
  </div>
</aside>

      </div>
    </main><footer class="footer mt-auto py-3 text-center container"><div class="offcanvas offcanvas-bottom h-auto" tabindex="-1" id="offcanvasActionsPanel"
  aria-labelledby="offcanvasActionsPanelLabel">
  <div class="offcanvas-header">
    <div class="offcanvas-title h5" id="offcanvasActionsPanelLabel">
      <i class="fas fa-fw fa-th-large me-1"></i>
      Actions
    </div>
    <button type="button" class="btn-close ms-auto" data-bs-dismiss="offcanvas" data-bs-target="offcanvasActionsPanel" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body mt-2"><div class="social-share mb-4 d-flex overflow-auto">
      <a class="btn-social-share d-flex flex-column align-items-center me-3" rel="noopener noreferrer" aria-label="Twitter Share Button"
      target="_blank" href="https://twitter.com/intent/tweet?title=404%20Page%20not%20found&url=https%3a%2f%2fericcsinger.com%2f404.html">
        <i class="fab fa-2x fa-fw fa-twitter mb-2"></i> Twitter
      </a>
      <a class="btn-social-share d-flex flex-column align-items-center me-3" rel="noopener noreferrer" aria-label="Facebook Share Button"
        target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fericcsinger.com%2f404.html">
        <i class="fab fa-2x fa-fw fa-facebook-f mb-2"></i> Facebook
      </a>
    </div>
    <hr class="mb-4"><div class="actions d-flex overflow-auto align-items-center">
      <a role="button" class="action action-go-back d-flex flex-column align-items-center me-3" href="javascript: window.history.back();">
        <span class="action-icon mb-2"><i class="fas fa-2x fa-chevron-circle-down" data-fa-transform="rotate-90"></i></span> Go back
      </a>
      <a role="button" class="action action-reload-page d-flex flex-column align-items-center me-3">
        <span class="action-icon mb-2"><i class="fas fa-2x fa-redo-alt"></i></span> Reload
      </a>
      <a role="button" class="action action-copy-url d-flex flex-column align-items-center me-3">
        <span class="action-icon mb-2"><i class="fas fa-2x fa-link"></i></span> Copy URL
      </a>
    </div>
  </div>
</div><div class="row text-center">
  <div class="col-12 mt-2">
    <p class="mb-2">Eric&#39;s Blog</p>
    <p class="text-secondary mb-2"><small>Eric IT Blog</small></p><div class="copyright mb-2 text-secondary">
  <small>©2025, Eric C. Singer
</small>
</div>
<div class="powered-by mb-2 text-secondary">
  <small>
    Build with ❤️ from the <a class="text-primary" href="https://gohugo.io" target="_blank" rel="noopener noreferrer">Hugo</a> and the <a class="text-primary" href="https://github.com/razonyang/hugo-theme-bootstrap" target="_blank" rel="noopener noreferrer">HBS</a> theme.
  </small>
</div>


<nav class="social-links nav justify-content-center mb-2 mt-3">
      <a class="nav-link social-link p-0 me-1 mb-2" target="_blank" href="https://github.com/ericcsinger" title="GitHub" rel="me">
        <i class="fa-fw fa-2x fab fa-github"
          ></i>
      </a>
      <a class="nav-link social-link p-0 me-1 mb-2" target="_blank" href="https://linkedin.com/in/ericcsinger" title="LinkedIn" rel="me">
        <i class="fa-fw fa-2x fab fa-linkedin-in"
           style="color: #0a66c2;"></i>
      </a>
      <a class="nav-link social-link p-0 me-1 mb-2" target="_blank" href="https://stackoverflow.com/users/1239030" title="Stack Overflow" rel="me">
        <i class="fa-fw fa-2x fab fa-stack-overflow"
           style="color: #f48024;"></i>
      </a>
      <a class="nav-link social-link p-0 me-1 mb-2" target="_blank" href="https://twitter.com/esinger" title="Twitter" rel="me">
        <i class="fa-fw fa-2x fab fa-twitter"
           style="color: #1d9bf0;"></i>
      </a>
  <a class="nav-link social-link p-0 me-1 mb-2" target="_blank" data-rss-feed href="https://ericcsinger.com/index.xml" title="RSS" rel="me">
    <i class="fas fa-fw fa-2x fa-rss" style="color: #ea6221;"></i>
  </a>
</nav>
</div>
  <div class="col-12 col-lg-8 offset-0 offset-lg-1"></div>
</div>
</footer>
<script data-precache src="/assets/main/bundle.min.8fb955cb1935fe23042ba0b0bfee9d8ee684a3b7e559915ffdc6fa74e1381632.js" integrity="sha256-j7lVyxk1/iMEK6Cwv&#43;6djuaEo7flWZFf/cb6dOE4FjI=" crossorigin="anonymous" async></script><script data-precache src="/assets/icons/bundle.min.16eedf63f2c395d2073253764cf197c28b18ac0264a7e0722c9b5b68f38201de.js" integrity="sha256-Fu7fY/LDldIHMlN2TPGXwosYrAJkp&#43;ByLJtbaPOCAd4=" crossorigin="anonymous" defer></script>
<script data-precache src="/assets/viewer/bundle.min.06371891cfe6d10d36cba465c61c4d7cb17591a3be2fd9af4a38444d2074e709.js" integrity="sha256-BjcYkc/m0Q02y6RlxhxNfLF1kaO&#43;L9mvSjhETSB05wk=" crossorigin="anonymous" defer></script>
  <script data-precache defer src="/assets/katex/bundle.min.ba733dc1a647d4293d838a9c0c37db25ab829bb2d7b4c00e2df53e2b663db53c.js" integrity="sha256-unM9waZH1Ck9g4qcDDfbJauCm7LXtMAOLfU&#43;K2Y9tTw=" crossorigin="anonymous"></script>



  </body>
</html>
